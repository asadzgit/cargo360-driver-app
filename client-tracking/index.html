<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Your Delivery - TruckTracker</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div class="tracking-container">
        <header class="header">
            <div class="header-content">
                <h1 class="title">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/>
                        <path d="M15 18H9"/>
                        <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/>
                        <circle cx="17" cy="18" r="2"/>
                        <circle cx="7" cy="18" r="2"/>
                    </svg>
                    Track Your Delivery
                </h1>
                <div class="live-indicator">
                    <div class="live-dot"></div>
                    <span>Live Tracking</span>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="journey-info-panel">
                <div class="journey-header">
                    <h2 id="journeyTitle">Loading journey...</h2>
                    <div class="journey-id">
                        Journey ID: <span id="journeyId">-</span>
                    </div>
                </div>

                <div class="progress-section">
                    <div class="progress-header">
                        <h3>Delivery Progress</h3>
                        <span id="progressPercentage" class="progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="remainingDistance">-</div>
                            <div class="stat-label">km remaining</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="estimatedTime">-</div>
                            <div class="stat-label">hours ETA</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="currentSpeed">-</div>
                            <div class="stat-label">km/h</div>
                        </div>
                    </div>
                </div>

                <div class="route-section">
                    <h3>Route Information</h3>
                    <div class="route-details">
                        <div class="location-item pickup">
                            <div class="location-icon pickup-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                    <circle cx="12" cy="10" r="3"/>
                                </svg>
                            </div>
                            <div class="location-info">
                                <div class="location-label">Pickup Location</div>
                                <div class="location-value" id="fromLocation">-</div>
                            </div>
                        </div>
                        
                        <div class="route-line"></div>
                        
                        <div class="location-item delivery">
                            <div class="location-icon delivery-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                    <circle cx="12" cy="10" r="3"/>
                                </svg>
                            </div>
                            <div class="location-info">
                                <div class="location-label">Delivery Location</div>
                                <div class="location-value" id="toLocation">-</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="driver-section">
                    <h3>Driver Information</h3>
                    <div class="driver-card">
                        <div class="driver-avatar">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div class="driver-info">
                            <div class="driver-name" id="driverName">-</div>
                            <div class="driver-status" id="driverStatus">Preparing for pickup</div>
                        </div>
                        <div class="driver-contact">
                            <button class="contact-btn" id="contactDriver">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="timeline-section">
                    <h3>Journey Updates</h3>
                    <div id="timeline" class="timeline">
                        <!-- Timeline items will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="map-container">
                <div class="map-header">
                    <h3>Live Location</h3>
                    <div class="map-controls">
                        <button id="centerMap" class="map-control-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Center
                        </button>
                        <button id="refreshLocation" class="map-control-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                                <path d="M21 3v5h-5"/>
                                <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                                <path d="M3 21v-5h5"/>
                            </svg>
                            Refresh
                        </button>
                    </div>
                </div>
                <div id="map" class="map"></div>
                
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-marker pickup-marker"></div>
                        <span>Pickup</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker delivery-marker"></div>
                        <span>Delivery</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker driver-marker"></div>
                        <span>Driver</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="connection-status" id="connectionStatus">
            <div class="connection-indicator" id="connectionIndicator"></div>
            <span id="connectionText">Connecting...</span>
        </div>

        <!-- Share Modal -->
        <div id="shareModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Share Tracking Link</h3>
                    <button id="closeModal" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Share this link with your client to track the delivery:</p>
                    <div class="share-link-container">
                        <input type="text" id="shareLink" class="share-link" readonly>
                        <button id="copyLink" class="copy-btn">Copy</button>
                    </div>
                    <div class="share-options">
                        <button class="share-btn email-btn">Email</button>
                        <button class="share-btn sms-btn">SMS</button>
                        <button class="share-btn whatsapp-btn">WhatsApp</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>